import{hydrate as T}from"preact";import{useEffect as y,useState as p}from"preact/hooks";import{jsx as r,jsxs as d}from"preact/jsx-runtime";function f({initialCounter:e}){let[n,c]=p(e),[u,s]=p(""),v=(i,t="")=>{c(i),t&&(s(t),setTimeout(()=>s(""),2e3))},l=async(i,t="GET")=>{try{s("Updating...");let o=await fetch(`/api/counter${i}`,{method:t,headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let b=await o.json();v(b.counter,"Updated!")}catch(o){console.error("API call failed:",o),s("Error updating counter"),setTimeout(()=>s(""),2e3)}};return y(()=>{let i=setInterval(async()=>{try{let t=await fetch("/api/counter");if(t.ok){let o=await t.json();o.counter!==n&&c(o.counter)}}catch(t){console.log("Background sync failed:",t)}},5e3);return()=>clearInterval(i)},[n]),d("div",{class:"counter-section",children:[r("h2",{children:"Server State Counter"}),r("div",{class:"counter-display",children:r("span",{id:"counter-value",children:n})}),d("div",{class:"counter-controls",children:[r("button",{type:"button",onClick:()=>l("/increment","POST"),children:"+"}),r("button",{type:"button",onClick:()=>l("/decrement","POST"),children:"---"}),r("button",{type:"button",onClick:()=>l("/reset","POST"),children:"Reset"})]}),r("div",{class:"status",children:u})]})}import{jsx as h,jsxs as C}from"preact/jsx-runtime";function m({files:e}){return C("div",{class:"files-section",children:[h("h3",{children:"Files:"}),h("p",{children:e.join(", ")})]})}import{Fragment as g,jsx as a,jsxs as A}from"preact/jsx-runtime";function P({counter:e,files:n}){return A(g,{children:[a("h1",{children:"Hello World"}),a("p",{children:"This is a t0555000"}),a(f,{initialCounter:e}),a(m,{files:n})]})}if(typeof globalThis.document<"u"){let e=document.getElementById("app");if(e){let n=globalThis.__INITIAL_DATA__,{counter:c,files:u}=n;T(a(P,{counter:c,files:u}),e)}}export{P as App};
